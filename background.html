<script>
[
  {title: "Open frame in this tab", type: "this-tab"},
  {title: "Open frame in new tab", type: "new-tab"},
  {title: "Open frame in new window", type: "window"},
  {title: "Open frame in incognito window", type: "incognito"}
].forEach(function(data) {
  var args = [data.type];
  chrome.contextMenus.create({
    title: data.title,
    onclick: function() {
      openFrame.apply(null, args.concat(Array.prototype.slice.call(arguments)));
    }
  });
  data = null;
});

function openFrame(container, clickData, tab) {
  var url = clickData.frameUrl || clickData.pageUrl;

  if (container == "this-tab")
    chrome.tabs.update(tab.id, {url:url});
  else if (container == "new-tab")
    chrome.tabs.create({url:url});
  else if (container == "window")
    chrome.windows.create({url:url});
  else if (container == "incognito")
    chrome.windows.create({url:url, incognito:true});
}
</script>
